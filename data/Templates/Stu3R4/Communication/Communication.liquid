{% mergeDiff msg -%}
{
  "instantiatesCanonical" : {{msg.definition | to_json_string}},
  {% if msg.notDone -%}
  "status" : "not-done",
  {% else %}
  "status" : "{{msg.status}}",
  {% endif -%}
  "statusReason" : {{msg.notDoneReason | to_json_string}},
  "extension" : [
    {% for t in msg.topic -%}
    {
      "url" : "http://hl7.org/fhir/r3/StructureDefinition/extension-Communication.topic",
      "valueReference" : {{ t | to_json_string }}
    },
    {% endfor -%}
  ],
  "notDoneReason" : "",
  "encounter" : {{msg.context | to_json_string}},
  "notDone" : "",
  "definition" : "",
  "topic" : "",
  "context" : ""
}
{% endmergeDiff -%}

