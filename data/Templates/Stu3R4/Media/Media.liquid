{% mergeDiff msg -%}
{
  {%if msg.type -%}
  "type" : {
    "coding" : {
      "system" : "http://terminology.hl7.org/CodeSystem/media-type",
      "code" : "{{msg.type}}"
    }
  },
  {% endif -%}
  "modality" : {{msg.subtype | to_json_string}},
  "encounter" : {{msg.context | to_json_string}},
  "createdDateTime" : "{{msg.occurrenceDateTime}}",
  "createdPeriod" : {{msg.occurrencePeriod | to_json_string}},
  "occurrence[x]" : "",
  "context" : "",
  "subtype" : ""
}
{% endmergeDiff -%}